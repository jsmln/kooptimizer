{% extends "base.html" %}
{% load static %}

{% block title %}Contact Us - KoopTimizer{% endblock %}

{% block extra_head %}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'frontend/contact.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
{% endblock %}

{% block content %}
<script src="https://www.google.com/recaptcha/api.js" async defer></script>
<div class="card shadow-sm" style="background-color: white; border: none; border-radius: 20px; max-width: 1200px; margin: 80px auto; padding: 20px;">
    <div class="card-body p-0">
        <div class="contact-wrapper" style="margin: 0; padding: 0;">
    
    <div class="contact-info-column">
        
        <div class="info-card">
            <div class="icon-box">
                <i class="bi bi-envelope"></i>
            </div>
            <div class="card-content">
                <h3>Get in Touch</h3>
                <p>We are delighted to discuss how we can work together. Our technical and support teams are here to help with any questions you may have.</p>
                <p style="margin-top: 15px;">
                    <strong>Email:</strong> kooptimizer@gmail.com<br>
                    <strong>Phone:</strong> +63 9929380935
                </p>
                <p style="margin-top: 15px;">
                    <a href="https://www.messenger.com/t/61585136364207" target="_blank" class="contact-link">Chat with Support →</a>
                </p>
            </div>
        </div>

        <div class="info-card" style="margin-top: 20px;">
            <div class="icon-box">
                <i class="bi bi-facebook"></i>
            </div>
            <div class="card-content">
                <h3>Stay Updated</h3>
                <p>Follow our official page for system updates, maintenance alerts, and technical assistance.</p>
                <p style="margin-top: 15px;">
                    <a href="https://web.facebook.com/profile.php?id=61585136364207" target="_blank" class="contact-link">Visit Facebook Page →</a>
                </p>
            </div>
        </div>
    </div>

    <div class="contact-form-column">
        <h2>Send Us Your Message</h2>

        {% if messages %}
            <div class="messages-container" style="margin-bottom: 20px;">
            {% for message in messages %}
                <div class="alert alert-dismissible fade show {% if message.tags == 'success' %}alert-success{% elif message.tags == 'error' %}alert-danger{% else %}alert-info{% endif %}" role="alert" style="border-radius: 8px; padding: 15px; display: flex; align-items: center; gap: 10px;">
                    {% if message.tags == 'success' %}
                        <i class="bi bi-check-circle-fill" style="font-size: 20px;"></i>
                    {% elif message.tags == 'error' %}
                        <i class="bi bi-exclamation-triangle-fill" style="font-size: 20px;"></i>
                    {% else %}
                        <i class="bi bi-info-circle-fill" style="font-size: 20px;"></i>
                    {% endif %}
                    <span style="flex: 1;">{{ message }}</span>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
            </div>
        {% endif %}

        <form method="POST">
            {% csrf_token %}
            
            <div class="form-group">
                <label for="name">Name <span>*</span></label>
                <input type="text" id="name" name="name" class="form-control" placeholder="Enter your name" required>
            </div>

            <div class="form-group">
                <label for="email">Email <span>*</span></label>
                <input type="email" id="email" name="email" class="form-control" placeholder="Enter your email" required>
            </div>

            <div class="form-group">
                <label for="phone">Phone Number</label>
                <input type="text" id="phone" name="phone" class="form-control" placeholder="Enter your phone number">
            </div>

            <div class="form-group">
                <label for="subject">Subject <span>*</span></label>
                <input type="text" id="subject" name="subject" class="form-control" placeholder="Summarize your request briefly" required>
            </div>

            <div class="form-group">
                <label for="message">How can we help? <span>*</span></label>
                <textarea id="message" name="message" class="form-control" placeholder="Provide details about your request" required></textarea>
            </div>

            <div class="form-group" style="display: flex; justify-content: center; margin: 20px 0;">
                <div id="recaptcha-placeholder" class="g-recaptcha" data-sitekey="6LeepvErAAAAAP3XNLdmBipdELXOuZqfo13T6lYE">
                </div>
            </div>

            <button type="submit" class="btn-submit" id="submit-btn">
                <span class="btn-text">Submit</span>
                <span class="btn-loading" style="display: none;">
                    <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                    Sending...
                </span>
            </button>

            <p class="legal-text">
                By clicking submit, you agree to our <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal">Terms & Conditions</a> and <a href="#" data-bs-toggle="modal" data-bs-target="#privacyModal">Privacy Policy</a>.
            </p>
        </form>
    </div>

        </div>
    </div>
</div>

    <!-- Terms & Conditions Modal -->
    <div class="modal fade" id="termsModal" tabindex="-1" aria-labelledby="termsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="termsModalLabel">Terms & Conditions</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <h6>1. Acceptance of Terms</h6>
                    <p>By accessing and using KoopTimizer, you accept and agree to be bound by these Terms & Conditions.</p>
                    
                    <h6>2. User Responsibilities</h6>
                    <p>You are responsible for maintaining the confidentiality of your account credentials and for all activities under your account.</p>
                    
                    <h6>3. Data Usage</h6>
                    <p>Your data will be used solely for the purposes of cooperative management and compliance with applicable Philippine laws.</p>
                    
                    <!-- Add more terms as needed -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Privacy Policy Modal -->
    <div class="modal fade" id="privacyModal" tabindex="-1" aria-labelledby="privacyModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="privacyModalLabel">Privacy Policy - Data Privacy Act of 2012</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <h6>Data Privacy Act of 2012 Compliance</h6>
                    <p>KoopTimizer is committed to protecting your personal information in accordance with the Data Privacy Act of 2012 (Republic Act No. 10173).</p>
                    
                    <h6>Information We Collect</h6>
                    <ul>
                        <li>Personal identification information (name, contact details)</li>
                        <li>Cooperative membership information</li>
                        <li>Transaction and communication records</li>
                    </ul>
                    
                    <h6>How We Use Your Information</h6>
                    <ul>
                        <li>To provide cooperative management services</li>
                        <li>To communicate important announcements</li>
                        <li>To comply with legal and regulatory requirements</li>
                    </ul>
                    
                    <h6>Your Rights</h6>
                    <p>Under the Data Privacy Act, you have the right to:</p>
                    <ul>
                        <li>Access your personal data</li>
                        <li>Correct inaccurate data</li>
                        <li>Request data portability</li>
                        <li>Object to processing</li>
                        <li>Request erasure (subject to legal requirements)</li>
                    </ul>
                    
                    <h6>Data Security</h6>
                    <p>We implement appropriate technical and organizational measures to protect your personal information.</p>
                    
                    <!-- Add more privacy policy content as needed -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const contactForm = document.querySelector('form');
    const submitBtn = document.getElementById('submit-btn');
    const btnText = submitBtn.querySelector('.btn-text');
    const btnLoading = submitBtn.querySelector('.btn-loading');
    
    let isSubmitting = false;

    contactForm.addEventListener('submit', function(e) {
        // Prevent double submission
        if (isSubmitting) {
            e.preventDefault();
            return false;
        }
        
        isSubmitting = true;
        
        // Show loading state
        btnText.style.display = 'none';
        btnLoading.style.display = 'inline-block';
        submitBtn.disabled = true;
        
        // Failsafe: Reset after 10 seconds if something goes wrong
        setTimeout(function() {
            if (isSubmitting) {
                resetButton();
            }
        }, 10000);
    });
    
    function resetButton() {
        isSubmitting = false;
        btnText.style.display = 'inline-block';
        btnLoading.style.display = 'none';
        submitBtn.disabled = false;
    }
    
    // Reset button on page show (back button, etc.)
    window.addEventListener('pageshow', function(e) {
        resetButton();
    });

    // Auto-dismiss alerts after 5 seconds
    const alerts = document.querySelectorAll('.alert');
    alerts.forEach(function(alert) {
        setTimeout(function() {
            const bsAlert = new bootstrap.Alert(alert);
            bsAlert.close();
        }, 5000);
    });
});
</script>
{% endblock %}